{% comment %}
  ABOUTME: Header with three navigation styles
  ABOUTME: topbar, hamburger, sidebar controlled via theme settings
{% endcomment %}

{% liquid
  assign nav_style = settings.navigation_style
%}

<header class="header header--{{ nav_style }}" data-nav-style="{{ nav_style }}">
  {% case nav_style %}
    {% when 'topbar' %}
      <div class="header__topbar container">
        <a href="/" class="header__logo">
          {% if settings.logo != blank %}
            <img src="{{ settings.logo | image_url: width: settings.logo_width }}" alt="{{ shop.name }}" width="{{ settings.logo_width }}">
          {% else %}
            <span class="header__logo-text">{{ shop.name }}</span>
          {% endif %}
        </a>
        <nav class="header__nav" role="navigation">
          {% for link in linklists.main-menu.links %}
            <a href="{{ link.url }}" class="header__nav-link">{{ link.title }}</a>
          {% endfor %}
        </nav>
        <div class="header__actions">
          <a href="{{ routes.search_url }}" class="header__icon" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
          </a>
          <a href="{{ routes.cart_url }}" class="header__icon header__cart" aria-label="Cart">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <span class="header__cart-count">{{ cart.item_count }}</span>
          </a>
        </div>
      </div>

    {% when 'hamburger' %}
      <div class="header__hamburger container">
        <button class="header__menu-toggle" aria-label="Menu" aria-expanded="false" data-menu-toggle>
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
        <a href="/" class="header__logo">
          {% if settings.logo != blank %}
            <img src="{{ settings.logo | image_url: width: settings.logo_width }}" alt="{{ shop.name }}" width="{{ settings.logo_width }}">
          {% else %}
            <span class="header__logo-text">{{ shop.name }}</span>
          {% endif %}
        </a>
        <div class="header__actions">
          <a href="{{ routes.cart_url }}" class="header__icon header__cart" aria-label="Cart">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <span class="header__cart-count">{{ cart.item_count }}</span>
          </a>
        </div>
      </div>
      <div class="header__menu-overlay" aria-hidden="true" data-menu-overlay>
        <button class="header__menu-close" aria-label="Close menu" data-menu-close>
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
        <nav class="header__menu-content">
          {% for link in linklists.main-menu.links %}
            <a href="{{ link.url }}" class="header__menu-link">{{ link.title }}</a>
          {% endfor %}
        </nav>
      </div>

    {% when 'sidebar' %}
      <aside class="header__sidebar">
        <a href="/" class="header__logo">
          {% if settings.logo != blank %}
            <img src="{{ settings.logo | image_url: width: settings.logo_width }}" alt="{{ shop.name }}" width="{{ settings.logo_width }}">
          {% else %}
            <span class="header__logo-text">{{ shop.name }}</span>
          {% endif %}
        </a>
        <nav class="header__nav" role="navigation">
          {% for link in linklists.main-menu.links %}
            <a href="{{ link.url }}" class="header__nav-link">{{ link.title }}</a>
          {% endfor %}
        </nav>
        <div class="header__actions">
          <a href="{{ routes.search_url }}" class="header__icon" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <span>Search</span>
          </a>
          <a href="{{ routes.cart_url }}" class="header__icon header__cart" aria-label="Cart">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <span>Cart ({{ cart.item_count }})</span>
          </a>
        </div>
      </aside>
  {% endcase %}
</header>

<style>
/* Base Header */
.header {
  font-family: var(--font-body);
}

.header__logo {
  text-decoration: none;
  color: var(--color-text);
}

.header__logo-text {
  font-family: var(--font-heading);
  font-size: 1.5rem;
  font-weight: 700;
}

.header__logo img {
  display: block;
  height: auto;
}

.header__nav-link {
  color: var(--color-text);
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  transition: color var(--transition-speed) ease;
}

.header__nav-link:hover {
  color: var(--color-accent);
}

.header__actions {
  display: flex;
  gap: var(--space-md);
  align-items: center;
}

.header__icon {
  color: var(--color-text);
  position: relative;
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  transition: color var(--transition-speed) ease;
}

.header__icon:hover {
  color: var(--color-accent);
}

.header__cart-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background: var(--color-accent);
  color: var(--color-background);
  font-size: 0.7rem;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
}

/* Topbar Navigation */
.header--topbar {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--color-background);
  border-bottom: 1px solid var(--color-secondary);
}

.header__topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-md);
  gap: var(--space-lg);
}

.header__topbar .header__nav {
  display: flex;
  gap: var(--space-lg);
}

/* Hamburger Navigation */
.header--hamburger {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--color-background);
  border-bottom: 1px solid var(--color-secondary);
}

.header__hamburger {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-md);
}

.header__menu-toggle {
  background: none;
  border: none;
  color: var(--color-text);
  cursor: pointer;
  padding: var(--space-xs);
}

.header__menu-overlay {
  position: fixed;
  inset: 0;
  background: var(--color-background);
  z-index: 200;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  transition: all var(--transition-speed) ease;
}

.header__menu-overlay.is-open {
  opacity: 1;
  visibility: visible;
}

.header__menu-close {
  position: absolute;
  top: var(--space-md);
  right: var(--space-md);
  background: none;
  border: none;
  color: var(--color-text);
  cursor: pointer;
  padding: var(--space-sm);
}

.header__menu-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-lg);
}

.header__menu-link {
  font-family: var(--font-heading);
  font-size: 2.5rem;
  color: var(--color-text);
  text-transform: uppercase;
  text-decoration: none;
  transition: color var(--transition-speed) ease;
}

.header__menu-link:hover {
  color: var(--color-accent);
}

/* Sidebar Navigation */
.header--sidebar {
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  width: 280px;
  background: var(--color-secondary);
  z-index: 100;
  display: flex;
  flex-direction: column;
  padding: var(--space-xl) var(--space-lg);
}

.header__sidebar .header__logo {
  margin-bottom: var(--space-xl);
}

.header__sidebar .header__nav {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
  flex: 1;
}

.header__sidebar .header__nav-link {
  font-size: 1.1rem;
  padding: var(--space-sm) 0;
  border-bottom: 1px solid var(--color-primary);
}

.header__sidebar .header__actions {
  flex-direction: column;
  align-items: flex-start;
  margin-top: auto;
  padding-top: var(--space-lg);
  border-top: 1px solid var(--color-primary);
}

.header__sidebar .header__icon {
  padding: var(--space-sm) 0;
}

.header__sidebar .header__cart-count {
  position: static;
  display: inline;
  background: none;
  color: var(--color-text);
  width: auto;
  height: auto;
}

/* Responsive */
@media (max-width: 768px) {
  .header--topbar .header__nav {
    display: none;
  }

  .header--sidebar {
    width: 100%;
    transform: translateX(-100%);
    transition: transform var(--transition-speed) ease;
  }

  .header--sidebar.is-open {
    transform: translateX(0);
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Hamburger menu toggle
  const menuToggle = document.querySelector('[data-menu-toggle]');
  const menuOverlay = document.querySelector('[data-menu-overlay]');
  const menuClose = document.querySelector('[data-menu-close]');

  if (menuToggle && menuOverlay) {
    menuToggle.addEventListener('click', function() {
      menuOverlay.classList.add('is-open');
      menuToggle.setAttribute('aria-expanded', 'true');
      document.body.style.overflow = 'hidden';
    });

    if (menuClose) {
      menuClose.addEventListener('click', function() {
        menuOverlay.classList.remove('is-open');
        menuToggle.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      });
    }

    // Close on overlay click
    menuOverlay.addEventListener('click', function(e) {
      if (e.target === menuOverlay) {
        menuOverlay.classList.remove('is-open');
        menuToggle.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      }
    });

    // Close on escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && menuOverlay.classList.contains('is-open')) {
        menuOverlay.classList.remove('is-open');
        menuToggle.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      }
    });
  }
});
</script>

{% schema %}
{
  "name": "Header",
  "class": "section-header",
  "settings": [
    {
      "type": "checkbox",
      "id": "sticky_header",
      "label": "t:sections.header.settings.sticky_header.label",
      "default": true,
      "info": "t:sections.header.settings.sticky_header.info"
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "t:sections.header.settings.show_search.label",
      "default": true
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "t:sections.header.settings.menu.label",
      "default": "main-menu"
    },
    {
      "type": "header",
      "content": "t:sections.header.settings.header_colors.content"
    },
    {
      "type": "checkbox",
      "id": "use_custom_colors",
      "label": "t:sections.header.settings.use_custom_colors.label",
      "default": false
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "t:sections.header.settings.background_color.label"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "t:sections.header.settings.text_color.label"
    },
    {
      "type": "header",
      "content": "t:sections.header.settings.header_spacing.content"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "t:sections.header.settings.padding_top.label",
      "min": 0,
      "max": 60,
      "step": 4,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "t:sections.header.settings.padding_bottom.label",
      "min": 0,
      "max": 60,
      "step": 4,
      "default": 16,
      "unit": "px"
    }
  ],
  "blocks": [
    { "type": "@app" }
  ]
}
{% endschema %}
